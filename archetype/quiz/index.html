<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Find Your Archetype - Personality Quiz</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root{
      --deep-green:#1a4d3a; --medium-green:#2d6b4f; --light-green:#4a8b6b;
      --gold:#d4af37; --dark-gold:#b8941f; --off-white:#f8f9fa; --light-gray:#e9ecef;
      --dark-text:#1a1a1a; --success-green:#52c41a; --warning-amber:#fa8c16; --info-teal:#13c2c2;
    }
    *{box-sizing:border-box}
    body{background:linear-gradient(135deg,var(--deep-green),var(--medium-green));min-height:100vh;font-size:16px;line-height:1.6}
    .quiz-container{max-width:800px;margin:0 auto;padding:20px}
    .question-card{background:rgba(248,249,250,.95);border-radius:16px;padding:32px;margin:24px 0;box-shadow:0 8px 32px rgba(0,0,0,.1);backdrop-filter:blur(10px);border:1px solid rgba(212,175,55,.2)}
    .option-button{background:var(--off-white);border:2px solid var(--light-gray);border-radius:12px;padding:16px 20px;margin:8px 0;width:100%;text-align:left;font-size:16px;color:var(--dark-text);cursor:pointer;transition:.3s all;position:relative}
    .option-button:hover{border-color:var(--gold);background:rgba(212,175,55,.05);transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,.1)}
    .option-button.selected{border-color:var(--gold);background:rgba(212,175,55,.1);box-shadow:0 0 0 2px rgba(212,175,55,.3)}
    .primary-button{background:var(--gold);color:var(--dark-text);border:none;border-radius:8px;padding:14px 28px;font-weight:600;cursor:pointer;transition:.3s all;box-shadow:0 4px 12px rgba(212,175,55,.3)}
    .primary-button:hover{background:var(--dark-gold);transform:translateY(-2px);box-shadow:0 6px 16px rgba(212,175,55,.4)}
    .primary-button:disabled{background:var(--light-gray);color:#6c757d;cursor:not-allowed;transform:none;box-shadow:none}
    .progress-bar{background:var(--light-gray);height:8px;border-radius:4px;overflow:hidden;margin:20px 0}
    .progress-fill{background:linear-gradient(90deg,var(--gold),var(--dark-gold));height:100%;transition:width .5s ease;border-radius:4px}
    .archetype-card{background:var(--off-white);border-radius:16px;padding:32px;margin:16px 0;border:2px solid var(--gold);box-shadow:0 8px 32px rgba(0,0,0,.1)}
    .archetype-icon{font-size:48px;margin-bottom:16px;display:block;text-align:center}
    .fade-in{animation:fadeIn .6s ease-out}
    @keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
    .slide-in{animation:slideIn .5s ease-out}
    @keyframes slideIn{from{opacity:0;transform:translateX(-20px)}to{opacity:1;transform:translateX(0)}}
    .pulse{animation:pulse 2s infinite}
    @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
    .question-number{background:var(--deep-green);color:var(--off-white);width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:bold;margin-bottom:16px}
    .intro-section{text-align:center;padding:40px 20px}
    .intro-title{font-size:48px;font-weight:bold;color:var(--off-white);margin-bottom:16px;text-shadow:2px 2px 4px rgba(0,0,0,.3)}
    .intro-subtitle{font-size:20px;color:var(--off-white);margin-bottom:32px;opacity:.9}
    .archetype-grid{display:grid;grid-template-columns:repeat(5,1fr);grid-template-rows:repeat(2,1fr);gap:12px;margin:32px auto;max-width:1000px}
    .archetype-preview{background:var(--deep-green);border:2px solid var(--gold);border-radius:16px;padding:20px 12px;text-align:center;color:var(--off-white);transition:.3s all;position:relative;overflow:hidden;min-height:120px;display:flex;flex-direction:column;justify-content:center;align-items:center}
    .archetype-preview::before{content:'';position:absolute;inset:0;background:linear-gradient(135deg,rgba(212,175,55,.1),transparent);opacity:0;transition:opacity .3s ease}
    .archetype-preview:hover{border-color:var(--gold);background:var(--medium-green);transform:translateY(-6px);box-shadow:0 8px 25px rgba(212,175,55,.3)}
    .archetype-preview:hover::before{opacity:1}
    .archetype-preview .archetype-icon{font-size:32px;margin-bottom:8px;filter:drop-shadow(0 2px 4px rgba(0,0,0,.3))}
    .archetype-preview .archetype-name{font-weight:bold;font-size:14px;color:var(--off-white);text-shadow:1px 1px 2px rgba(0,0,0,.5);line-height:1.2}
    @media (max-width:768px){.archetype-grid{grid-template-columns:repeat(2,1fr);grid-template-rows:repeat(5,1fr);gap:10px}.archetype-preview{min-height:100px;padding:16px 8px}.archetype-preview .archetype-icon{font-size:28px;margin-bottom:6px}.archetype-preview .archetype-name{font-size:12px}}
    .result-stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:16px;margin:24px 0}
    .stat-card{background:var(--light-gray);border-radius:8px;padding:16px;text-align:center}
    .stat-number{font-size:24px;font-weight:bold;color:var(--deep-green)}
    .stat-label{font-size:14px;color:#6c757d;margin-top:4px}
    /* Modal */
    .modal-bg{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;align-items:center;justify-content:center;padding:16px;z-index:50}
    .modal{background:var(--off-white);border:2px solid var(--gold);border-radius:16px;max-width:640px;width:100%;box-shadow:0 12px 40px rgba(0,0,0,.25);animation:fadeIn .35s ease}
    .modal-header{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;border-bottom:1px solid rgba(0,0,0,.06)}
    .modal-body{padding:16px 20px}
    .app-grid{display:grid;grid-template-columns:repeat(1,1fr);gap:10px}
    .app-btn{display:block;width:100%;text-align:center;border-radius:10px;padding:12px 14px;background:var(--gold);color:var(--dark-text);font-weight:700;box-shadow:0 2px 0 rgba(0,0,0,.2);transition:.2s transform}
    .app-btn:hover{transform:translateY(-2px)}
  </style>
</head>
<body>
  <!-- Intro -->
  <div id="introScreen" class="quiz-container">
    <div class="intro-section fade-in">
      <h1 class="intro-title">üé≠ Find Your Archetype</h1>
      <p class="intro-subtitle">Discover your core personality pattern through 25 carefully crafted questions</p>

      <div class="question-card">
        <h2 class="text-2xl font-bold text-[var(--deep-green)] mb-4">The 10 Archetypes</h2>
        <div class="archetype-grid">
          <div class="archetype-preview"><div class="archetype-icon">üõ†Ô∏è</div><div class="archetype-name">The Builder</div></div>
          <div class="archetype-preview"><div class="archetype-icon">üîç</div><div class="archetype-name">The Analyst</div></div>
          <div class="archetype-preview"><div class="archetype-icon">ü§ù</div><div class="archetype-name">The Connector</div></div>
          <div class="archetype-preview"><div class="archetype-icon">üé®</div><div class="archetype-name">The Creator</div></div>
          <div class="archetype-preview"><div class="archetype-icon">üíù</div><div class="archetype-name">The Caregiver</div></div>
          <div class="archetype-preview"><div class="archetype-icon">üëë</div><div class="archetype-name">The Leader</div></div>
          <div class="archetype-preview"><div class="archetype-icon">‚ôüÔ∏è</div><div class="archetype-name">The Strategist</div></div>
          <div class="archetype-preview"><div class="archetype-icon">üó∫Ô∏è</div><div class="archetype-name">The Explorer</div></div>
          <div class="archetype-preview"><div class="archetype-icon">üé≠</div><div class="archetype-name">The Performer</div></div>
          <div class="archetype-preview"><div class="archetype-icon">‚úÖ</div><div class="archetype-name">The Finisher</div></div>
        </div>

        <div class="bg-[var(--light-gray)] rounded-lg p-6 mt-6">
          <h3 class="text-lg font-bold text-[var(--deep-green)] mb-3">üìã How It Works</h3>
          <ul class="text-left text-[var(--dark-text)] space-y-2">
            <li>‚Ä¢ 25 thoughtfully designed questions</li>
            <li>‚Ä¢ Each question reveals different aspects of your personality</li>
            <li>‚Ä¢ No right or wrong answers, be honest for best results</li>
            <li>‚Ä¢ Takes about 5 to 7 minutes to complete</li>
            <li>‚Ä¢ Get detailed insights about your archetype</li>
          </ul>
        </div>

        <button onclick="startQuiz()" class="primary-button mt-8 pulse">üöÄ Start Your Journey</button>
      </div>
    </div>
  </div>

  <!-- Quiz -->
  <div id="quizScreen" class="quiz-container hidden">
    <div class="question-card fade-in">
      <div class="flex justify-between items-center mb-6">
        <div class="question-number" id="questionNumber">1</div>
        <div class="text-sm text-[var(--deep-green)] font-semibold" id="progressText">Question 1 of 25</div>
      </div>
      <div class="progress-bar"><div class="progress-fill" id="progressFill" style="width:4%"></div></div>
      <h2 class="text-2xl font-bold text-[var(--deep-green)] mb-6" id="questionText">Loading question...</h2>
      <div id="optionsContainer" class="space-y-3"></div>
      <div class="flex justify-between mt-8">
        <button onclick="previousQuestion()" id="prevButton" class="primary-button" style="background:var(--light-gray);color:var(--dark-text)" disabled>‚Üê Previous</button>
        <button onclick="nextQuestion()" id="nextButton" class="primary-button" disabled>Next ‚Üí</button>
      </div>
    </div>
  </div>

  <!-- Results -->
  <div id="resultsScreen" class="quiz-container hidden">
    <div class="archetype-card fade-in">
      <div class="text-center mb-8">
        <h1 class="text-4xl font-bold text-[var(--deep-green)] mb-4">üéâ Your Archetype Revealed</h1>
        <div class="archetype-icon" id="resultIcon">üé≠</div>
        <h2 class="text-3xl font-bold text-[var(--deep-green)] mb-2" id="resultTitle">Your Archetype</h2>
        <p class="text-lg text-[var(--dark-text)] mb-6" id="resultTagline">Your unique personality pattern</p>
      </div>

      <div class="result-stats">
        <div class="stat-card"><div class="stat-number" id="matchPercentage">95%</div><div class="stat-label">Match Strength</div></div>
        <div class="stat-card"><div class="stat-number" id="dominantTraits">3</div><div class="stat-label">Dominant Traits</div></div>
        <div class="stat-card"><div class="stat-number" id="compatibilityScore">8.5</div><div class="stat-label">Leadership Score</div></div>
      </div>

      <div class="bg-[var(--light-gray)] rounded-lg p-6 mb-6">
        <h3 class="text-xl font-bold text-[var(--deep-green)] mb-4">üìñ Core Description</h3>
        <p class="text-[var(--dark-text)] leading-relaxed" id="resultDescription">Your detailed archetype description will appear here...</p>
      </div>

      <div class="bg-[var(--light-gray)] rounded-lg p-6 mb-6">
        <h3 class="text-xl font-bold text-[var(--deep-green)] mb-4">üí™ Key Strengths</h3>
        <ul class="text-[var(--dark-text)] space-y-2" id="resultStrengths"></ul>
      </div>

      <div class="bg-[var(--light-gray)] rounded-lg p-6 mb-6">
        <h3 class="text-xl font-bold text-[var(--deep-green)] mb-4">üéØ Growth Areas</h3>
        <ul class="text-[var(--dark-text)] space-y-2" id="resultGrowthAreas"></ul>
      </div>

      <div class="bg-[var(--light-gray)] rounded-lg p-6 mb-6">
        <h3 class="text-xl font-bold text-[var(--deep-green)] mb-4">ü§ù Compatible Archetypes</h3>
        <div class="grid grid-cols-2 md:grid-cols-3 gap-3" id="compatibleArchetypes"></div>
      </div>

      <!-- External result injection -->
      <div class="bg-[var(--light-gray)] rounded-lg p-6 mb-6">
        <h3 class="text-xl font-bold text-[var(--deep-green)] mb-4">üì¶ Extra Insights</h3>
        <div id="externalResultContainer" class="text-[var(--dark-text)]">Loading‚Ä¶</div>
      </div>

      <div class="text-center">
        <button onclick="restartQuiz()" class="primary-button mr-4">üîÑ Take Quiz Again</button>
        <button id="openAppsBtn" class="primary-button" style="background:var(--medium-green);color:var(--off-white)">‚ú® Recommended Tools</button>
      </div>
    </div>
  </div>

  <!-- Modal: Recommended Apps -->
  <div id="appsModal" class="modal-bg">
    <div class="modal">
      <div class="modal-header">
        <h3 class="text-lg font-bold text-[var(--deep-green)]" id="appsModalTitle">Recommended Tools</h3>
        <button class="primary-button" style="padding:6px 10px" onclick="closeApps()">‚úï</button>
      </div>
      <div class="modal-body">
        <p class="mb-3 text-[var(--dark-text)]" id="appsModalHint">Based on your archetype</p>
        <div id="appsContainer" class="app-grid"></div>
      </div>
    </div>
  </div>

  <script>
    // Quiz data trimmed for brevity, keep your full questions here
    const questions = [/* keep your existing questions array exactly as-is */];
  </script>

  <script>
    // Archetypes and icons
    const archetypes = {
      builder:{name:"The Builder",icon:"üõ†Ô∏è",tagline:"You create lasting foundations and turn visions into reality",
        description:"Builders are the architects of progress. You take abstract concepts and transform them into working systems.",
        strengths:["Project management and organization","See big picture and details","Practical problem solving","Efficient systems","Reliable follow through"],
        growthAreas:["Flex when plans change","Balance polish with delivery","Delegate more","Try unconventional approaches"],
        compatibleArchetypes:["strategist","finisher","analyst","leader"]
      },
      analyst:{name:"The Analyst",icon:"üîç",tagline:"You uncover hidden patterns and provide clarity through insight",
        description:"Analysts bring clarity to complexity and distill insights that drive better decisions.",
        strengths:["Research and analysis","Find patterns and trends","Critical thinking","Break down complexity","Evidence based"],
        growthAreas:["Share insights simply","Decide with incomplete info","Balance analysis with action","Factor in people"],
        compatibleArchetypes:["strategist","builder","explorer","finisher"]
      },
      connector:{name:"The Connector",icon:"ü§ù",tagline:"You build bridges between people and create thriving communities",
        description:"Connectors unite people, nurture relationships, and spark collaboration.",
        strengths:["Interpersonal skills","Relationship building","Facilitation","Emotional intelligence","Conflict resolution"],
        growthAreas:["Set boundaries","Make tough calls","Finish tasks too","Advocate for yourself"],
        compatibleArchetypes:["caregiver","leader","performer","creator"]
      },
      creator:{name:"The Creator",icon:"üé®",tagline:"You bring imagination to life and inspire through innovation",
        description:"Creators see possibilities and turn them into inspiring work.",
        strengths:["Creativity","Vision","Inspire others","Comfort with ambiguity","Design sense"],
        growthAreas:["Finish more","Work with constraints","Partner with structure","Balance vision with market"],
        compatibleArchetypes:["explorer","performer","connector","builder"]
      },
      caregiver:{name:"The Caregiver",icon:"üíù",tagline:"You nurture growth and create environments where others thrive",
        description:"Caregivers support growth with empathy and patience.",
        strengths:["Deep empathy","Mentoring","Inclusive spaces","Listening","Spot potential"],
        growthAreas:["Boundaries to avoid burnout","Advocate needs","Make hard choices","Balance support with accountability"],
        compatibleArchetypes:["connector","leader","builder","finisher"]
      },
      leader:{name:"The Leader",icon:"üëë",tagline:"You inspire action and guide others toward ambitious goals",
        description:"Leaders rally people around a vision and steer toward outcomes.",
        strengths:["Inspire action","Decide under pressure","Strategic thinking","Own responsibility","Motivate teams"],
        growthAreas:["Listen first","Be patient with pace","Share credit","Manage stress"],
        compatibleArchetypes:["strategist","connector","builder","finisher"]
      },
      strategist:{name:"The Strategist",icon:"‚ôüÔ∏è",tagline:"You see the big picture and navigate complex challenges with wisdom",
        description:"Strategists plan ahead, model scenarios, and allocate wisely.",
        strengths:["Long term planning","Systems thinking","Analysis and synthesis","Anticipate consequences","Prioritize well"],
        growthAreas:["Act without perfect info","Explain simply","Adapt fast","Balance strategy with execution"],
        compatibleArchetypes:["analyst","leader","builder","finisher"]
      },
      explorer:{name:"The Explorer",icon:"üó∫Ô∏è",tagline:"You discover new frontiers and embrace the unknown with courage",
        description:"Explorers thrive in change and find new opportunities.",
        strengths:["Adaptability","Curiosity","Calculated risks","Spot opportunities","Inspire exploration"],
        growthAreas:["Finish commitments","Use systems","Patience for planning","Balance novelty with duty"],
        compatibleArchetypes:["creator","analyst","performer","connector"]
      },
      performer:{name:"The Performer",icon:"üé≠",tagline:"You energize others and bring ideas to life through engagement",
        description:"Performers engage audiences and move ideas into action.",
        strengths:["Communication","Charisma","Make ideas accessible","Energy and enthusiasm","Style flexibility"],
        growthAreas:["Build depth","Follow through","Balance performance with relationship","Manage energy"],
        compatibleArchetypes:["creator","connector","leader","explorer"]
      },
      finisher:{name:"The Finisher",icon:"‚úÖ",tagline:"You ensure excellence through attention to detail and follow-through",
        description:"Finishers raise quality and land the work.",
        strengths:["Detail and quality","Follow through","Catch errors","Meet deadlines","Improve processes"],
        growthAreas:["Balance perfection and speed","Delegate without micro-managing","Accept good enough","Focus on high impact details"],
        compatibleArchetypes:["builder","analyst","strategist","caregiver"]
      }
    };

    // Ko-fi app suggestions by archetype
    const suggestedApps = {
      builder: [
        {name:"Motivational Tracking App", url:"https://ko-fi.com/lifebalanceq/shop#motivational-tracking"},
        {name:"Task Management App",     url:"https://ko-fi.com/lifebalanceq/shop#task-management"}
      ],
      analyst: [
        {name:"Data Visualization App",  url:"https://ko-fi.com/lifebalanceq/shop#data-visualization"},
        {name:"Decision Support App",    url:"https://ko-fi.com/lifebalanceq/shop#decision-support"}
      ],
      connector: [
        {name:"Professional Networking Scripts", url:"https://ko-fi.com/lifebalanceq/shop#networking-scripts"},
        {name:"Social Balance App",              url:"https://ko-fi.com/lifebalanceq/shop#social-balance"},
        {name:"Relationship Board App",          url:"https://ko-fi.com/lifebalanceq/shop#relationship-board"}
      ],
      creator: [
        {name:"Consistency Tracker App", url:"https://ko-fi.com/lifebalanceq/shop#consistency-tracker"},
        {name:"Idea Capture App",        url:"https://ko-fi.com/lifebalanceq/shop#idea-capture"},
        {name:"Ideation Prompt",         url:"https://ko-fi.com/lifebalanceq/shop#ideation-prompt"}
      ],
      caregiver: [
        {name:"Boundary Management App", url:"https://ko-fi.com/lifebalanceq/shop#boundary-management"},
        {name:"Self-care Planner App",   url:"https://ko-fi.com/lifebalanceq/shop#self-care-planner"}
      ],
      leader: [
        {name:"Delegation Tool App",     url:"https://ko-fi.com/lifebalanceq/shop#delegation-tool"},
        {name:"Team Motivation App",     url:"https://ko-fi.com/lifebalanceq/shop#team-motivation"}
      ],
      strategist: [
        {name:"Planning Visualization App", url:"https://ko-fi.com/lifebalanceq/shop#planning-visualization"},
        {name:"Strategy Simulation App",    url:"https://ko-fi.com/lifebalanceq/shop#strategy-simulation"}
      ],
      explorer: [
        {name:"Safety Preparation App",     url:"https://ko-fi.com/lifebalanceq/shop#safety-preparation"},
        {name:"Adventure Planning App",     url:"https://ko-fi.com/lifebalanceq/shop#adventure-planning"}
      ],
      performer: [
        {name:"Feedback Recovery App",      url:"https://ko-fi.com/lifebalanceq/shop#feedback-recovery"},
        {name:"Performer Prep App",         url:"https://ko-fi.com/lifebalanceq/shop#performer-prep"}
      ],
      finisher: [
        {name:"Achievement Logging App",    url:"https://ko-fi.com/lifebalanceq/shop#achievement-logging"},
        {name:"Task Completion App",        url:"https://ko-fi.com/lifebalanceq/shop#task-completion"}
      ]
    };

    // Quiz state
    let currentQuestion = 0;
    let answers = {};
    let scores = {};
    Object.keys(archetypes).forEach(k => scores[k]=0);

    function startQuiz(){
      document.getElementById('introScreen').classList.add('hidden');
      document.getElementById('quizScreen').classList.remove('hidden');
      loadQuestion();
    }
    function loadQuestion(){
      const q = questions[currentQuestion];
      document.getElementById('questionNumber').textContent = currentQuestion+1;
      document.getElementById('progressText').textContent = `Question ${currentQuestion+1} of ${questions.length}`;
      document.getElementById('questionText').textContent = q.text;
      document.getElementById('progressFill').style.width = (((currentQuestion+1)/questions.length)*100)+'%';
      const box = document.getElementById('optionsContainer'); box.innerHTML='';
      q.options.forEach((opt,i)=>{
        const b=document.createElement('button');
        b.className='option-button slide-in'; b.style.animationDelay=`${i*0.1}s`; b.textContent=opt.text;
        b.onclick=()=>selectOption(i); box.appendChild(b);
      });
      document.getElementById('prevButton').disabled = currentQuestion===0;
      document.getElementById('nextButton').disabled = true;
      delete answers[currentQuestion];
    }
    function selectOption(i){
      document.querySelectorAll('.option-button').forEach(btn=>btn.classList.remove('selected'));
      document.querySelectorAll('.option-button')[i].classList.add('selected');
      answers[currentQuestion]=i;
      document.getElementById('nextButton').disabled=false;
      setTimeout(()=>{ if(answers[currentQuestion]===i) nextQuestion(); },800);
    }
    function nextQuestion(){
      if(answers[currentQuestion]===undefined) return;
      const q=questions[currentQuestion];
      const opt=q.options[answers[currentQuestion]];
      Object.entries(opt.archetypes).forEach(([k,p])=>scores[k]+=p);
      currentQuestion++;
      if(currentQuestion>=questions.length){ showResults(); } else { loadQuestion(); }
    }
    function previousQuestion(){
      if(currentQuestion>0){ currentQuestion--; loadQuestion();
        if(answers[currentQuestion]!==undefined){
          document.querySelectorAll('.option-button')[answers[currentQuestion]].classList.add('selected');
          document.getElementById('nextButton').disabled=false;
        }
      }
    }

    async function showResults(){
      // dominant archetype
      let max=0, dom='';
      Object.entries(scores).forEach(([k,v])=>{ if(v>max){max=v; dom=k;} });
      const result = archetypes[dom];

      const maxPossible = questions.length*3;
      const matchPct = Math.round((max/maxPossible)*100);
      const avg = Object.values(scores).reduce((a,b)=>a+b,0)/Object.keys(scores).length;
      const dominantTraits = Object.values(scores).filter(s=>s>avg).length;
      const leadershipScore = (((scores.leader||0)+(scores.strategist||0)+(scores.connector||0))/(maxPossible*3)*10).toFixed(1);

      // update UI
      document.getElementById('resultIcon').textContent=result.icon;
      document.getElementById('resultTitle').textContent=result.name;
      document.getElementById('resultTagline').textContent=result.tagline;
      document.getElementById('resultDescription').textContent=result.description;
      document.getElementById('matchPercentage').textContent=matchPct+'%';
      document.getElementById('dominantTraits').textContent=dominantTraits;
      document.getElementById('compatibilityScore').textContent=leadershipScore;

      const strengthsUl=document.getElementById('resultStrengths');
      strengthsUl.innerHTML=result.strengths.map(s=>`<li class="flex items-start"><span class="text-[var(--success-green)] mr-2">‚úì</span>${s}</li>`).join('');
      const growthUl=document.getElementById('resultGrowthAreas');
      growthUl.innerHTML=result.growthAreas.map(s=>`<li class="flex items-start"><span class="text-[var(--warning-amber)] mr-2">‚Üí</span>${s}</li>`).join('');
      const compat=document.getElementById('compatibleArchetypes');
      compat.innerHTML=result.compatibleArchetypes.map(k=>{
        const c=archetypes[k];
        return `<div class="bg-[var(--light-gray)] rounded-lg p-3 text-center border" style="border-color:var(--deep-green)">
                  <div class="text-2xl mb-1">${c.icon}</div>
                  <div class="text-sm font-semibold text-[var(--deep-green)]">${c.name}</div>
                </div>`;
      }).join('');

      // swap screens
      document.getElementById('quizScreen').classList.add('hidden');
      document.getElementById('resultsScreen').classList.remove('hidden');

      // fetch and inject external results page
      try{
        const res = await fetch('result/index.html', {cache:'no-store'});
        const html = await res.text();
        document.getElementById('externalResultContainer').innerHTML = html;
      }catch(e){
        document.getElementById('externalResultContainer').textContent = 'Could not load extra insights.';
      }

      // prepare and show recommended apps modal
      prepareApps(dom, result.name, result.icon);
      openApps(); // auto open once results are ready
      // also enable manual open
      document.getElementById('openAppsBtn').onclick = ()=>openApps();
    }

    function prepareApps(key, name, icon){
      const list = suggestedApps[key] || [];
      document.getElementById('appsModalTitle').textContent = `Recommended Tools for ${icon} ${name}`;
      document.getElementById('appsModalHint').textContent = 'Pick a tool to start now';
      const box = document.getElementById('appsContainer');
      box.innerHTML = list.map(app=>`<a class="app-btn" href="${app.url}" target="_blank" rel="noopener">${app.name}</a>`).join('');
    }
    function openApps(){ document.getElementById('appsModal').style.display='flex'; }
    function closeApps(){ document.getElementById('appsModal').style.display='none'; }

    function restartQuiz(){
      currentQuestion=0; answers={}; Object.keys(archetypes).forEach(k=>scores[k]=0);
      document.getElementById('resultsScreen').classList.add('hidden');
      document.getElementById('introScreen').classList.remove('hidden');
    }

    function shareResults(){
      const t=document.getElementById('resultTitle').textContent;
      const tag=document.getElementById('resultTagline').textContent;
      const pct=document.getElementById('matchPercentage').textContent;
      const text=`I just discovered I am ${t}. ${tag} (${pct} match). Try it.`;
      if(navigator.share){ navigator.share({title:'My Personality Archetype',text, url:location.href}); }
      else { navigator.clipboard.writeText(text+' '+location.href).then(()=>alert('Copied to clipboard')); }
    }

    document.addEventListener('DOMContentLoaded', ()=>{
      document.querySelectorAll('.archetype-preview').forEach((el,i)=>{
        el.style.animationDelay=`${i*0.1}s`; el.classList.add('fade-in');
      });
    });
  </script>
</body>
</html>
